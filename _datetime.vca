*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="_datetime.vcx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS _clock AS _container OF "_base.vcx" 		&& day, date, and time control
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" ProjectClassIcon="graphics\clock.bmp" ClassIcon="graphics\clock.bmp" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="txtDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Timer1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*p: timeformat		&& Toggles between 12 and 24 hour format.
	*</DefinedPropArrayMethod>

	BackStyle = 0
	BorderWidth = 0
	Height = 28
	Name = "_clock"
	timeformat = 0		&& Toggles between 12 and 24 hour format.
	Width = 263

	ADD OBJECT 'Timer1' AS _timer WITH ;
		Height = 12, ;
		Interval = 1000, ;
		Left = 8, ;
		Name = "Timer1", ;
		Top = 3, ;
		Width = 14
		*< END OBJECT: ClassLib="_base.vcx" BaseClass="timer" />

	ADD OBJECT 'txtDate' AS _textbox WITH ;
		Alignment = 2, ;
		BackColor = 255,255,0, ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DateFormat = 13, ;
		DisabledBackColor = 255,255,255, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 3, ;
		Name = "txtDate", ;
		Top = 5, ;
		Width = 256
		*< END OBJECT: ClassLib="_base.vcx" BaseClass="textbox" />
	
	PROCEDURE DblClick
		THIS.TimeFormat = ABS(THIS.TimeFormat - 1)
		THIS.txtDate.DateFormat = IIF(THIS.TimeFormat=0,13,14)
		
	ENDPROC

	PROCEDURE Timer1.Timer
		This.Parent.txtDate.Value = DATETIME()
		
	ENDPROC

ENDDEFINE

DEFINE CLASS _olecalendar AS olecontrol 
 	*< CLASSDATA: Baseclass="olecontrol" Timestamp="" Scale="Pixels" Uniqueid="" Nombre="_olecalendar" Parent="" ObjName="_olecalendar" OLEObject="C:\Windows\SysWOW64\mscomct2.ocx" Value="REkR4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAF//CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAABf////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9////X////1////9f/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3GjFovNMBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAABf////X////wUAAABf//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9qRS4jQYfREYthAABvdU2hIUM0EggAAADhEQAAZhIAABqxX0EAAAYAHAAAAIoIAADRBwIAAAAKAAAAAAAAAAAAXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA2NTFBODk0MC04N0M1LTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADycMAAUAHwAAAAAAAAAAAFUGAQABAAEAAAAAAAAAAADRBwIABgAKABIALQAOAF4B0QcCAAYACgASAC0ADgBeAQAABwAAAAAAAe/NqwAABQABAAAABgBXAAAAAABPSbsACAAAAB9f7L0BAAUAQesZADcANQAyADcALQAxADYAMAA2ADAAXwBDAGwAYQBzAHMAZQBzAFwAegBhAHAAZgBpAGwAZQBcAEMATABTAEkARAAAAGEAYgBsAGUAAABkAEYAaQBsAGUARQBkAGkAdABpAG4AZwBcAHMAZQByAHYAZQByAAAAMQA1ADUANQB9AAAASQBuAFAAcgBvAGMAUwBlAA==" />

	*<DefinedPropArrayMethod>
		*m: refreshdisplay
		*p: builder
		*p: builderx
		*p: date_column
	*</DefinedPropArrayMethod>

	builder = 
	builderx = (HOME()+"Wizards\BuilderD,BuilderDForm")
	date_column = 
	Height = 180
	Name = "_olecalendar"
	Width = 198
	
	PROCEDURE DateDblClick
		*** ActiveX Control Event ***
		LPARAMETERS datedblclicked
		thisform.KeyPress(13, 0)
		
	ENDPROC

	PROCEDURE KeyPress
		*** ActiveX Control Event ***
		LPARAMETERS keyascii
		do case
		case keyascii = 13
			thisform.KeyPress(13, 0)
		case keyascii = 27
			thisform.KeyPress(27, 0)
		endcase
		
	ENDPROC

	PROCEDURE refreshdisplay
		LOCAL cColumn
		cColumn = this.date_column
		
		IF !EMPTY(m.cColumn) THEN
			THIS.Month = MONTH(&cColumn)
			THIS.Day = DAY(&cColumn)
			THIS.Year = YEAR(&cColumn)
		ENDIF
		
	ENDPROC

	PROCEDURE SelChange
		*** ActiveX Control Event ***
		LPARAMETERS startdate, enddate, cancel
		
		nYear = YEAR(startdate)
		nDay = DAY(startdate)
		nMonth = MONTH(startdate)
		
		dValue = DATE(m.nYear, m.nMonth, m.nDay)
		
		cColumn = THIS.date_column
		
		IF !EMPTY(m.cColumn)
			REPLACE &cColumn WITH m.dValue
		ENDIF
		
		IF TYPE("THISFORM")="O"
			THISFORM.Refresh
		ENDIF
		
	ENDPROC

ENDDEFINE

DEFINE CLASS _stopwatch AS _container OF "_base.vcx" 		&& stop watch with start, stop, and reset methods
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" ProjectClassIcon="graphics\watch.bmp" ClassIcon="graphics\watch.bmp" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="tmrSWatch" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblSeparator1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblSeparator2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblhours" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblMinutes" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblSeconds" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: increment		&& Increment the stopwatch display.
		*m: reset		&& Resets stopwatch.
		*m: start		&& Starts stopwatch.
		*m: stop		&& Stops stopwatch.
		*m: updatedisplay		&& Refresh display.
		*p: elapsedseconds		&& The time displayed in the stopwatch in elapsed seconds.
		*p: nhour
		*p: nmin
		*p: nsec
	*</DefinedPropArrayMethod>

	PROTECTED nhour,nmin,nsec
	BackStyle = 0
	BorderWidth = 0
	elapsedseconds = 0		&& The time displayed in the stopwatch in elapsed seconds.
	Height = 27
	Name = "_stopwatch"
	nhour = 0
	nmin = 0
	nsec = 0
	Width = 92

	ADD OBJECT 'lblhours' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "00", ;
		FontBold = .T., ;
		FontName = "Arial", ;
		FontSize = 13, ;
		Height = 22, ;
		Left = 6, ;
		Name = "lblhours", ;
		Top = 5, ;
		Width = 20
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblMinutes' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "00", ;
		FontBold = .T., ;
		FontName = "Arial", ;
		FontSize = 13, ;
		Height = 22, ;
		Left = 37, ;
		Name = "lblMinutes", ;
		Top = 5, ;
		Width = 20
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblSeconds' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "00", ;
		FontBold = .T., ;
		FontName = "Arial", ;
		FontSize = 13, ;
		Height = 22, ;
		Left = 68, ;
		Name = "lblSeconds", ;
		Top = 5, ;
		Width = 20
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblSeparator1' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = ":", ;
		FontBold = .T., ;
		FontName = "Arial", ;
		FontSize = 13, ;
		Height = 22, ;
		Left = 26, ;
		Name = "lblSeparator1", ;
		Top = 4, ;
		Width = 8
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblSeparator2' AS label WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = ":", ;
		FontBold = .T., ;
		FontName = "Arial", ;
		FontSize = 13, ;
		Height = 19, ;
		Left = 58, ;
		Name = "lblSeparator2", ;
		Top = 4, ;
		Width = 11
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'tmrSWatch' AS _timer WITH ;
		Height = 25, ;
		Interval = 1000, ;
		Left = 52, ;
		Name = "tmrSWatch", ;
		Top = 2, ;
		Width = 25
		*< END OBJECT: ClassLib="_base.vcx" BaseClass="timer" />
	
	PROCEDURE increment		&& Increment the stopwatch display.
		THIS.nSec = THIS.nSec + 1
		
		IF THIS.nSec = 60
			THIS.nSec = 0
			THIS.nMin = THIS.nMin + 1
		ENDIF
		
		IF THIS.nMin = 60
			THIS.nMin = 0
			THIS.nHour = THIS.nHour + 1
		ENDIF
		THIS.UpdateDisplay
		THIS.ElapsedSeconds = (THIS.nHour * 3600) + ;
		                               (THIS.nMin * 60) + ;
		                                (This.nSec)
		
	ENDPROC

	PROCEDURE Init
		#DEFINE SEPARATOR_LOC ':'
		
		This.lblSeparator1.Caption = SEPARATOR_LOC
		This.lblSeparator2.Caption = SEPARATOR_LOC
		
	ENDPROC

	PROCEDURE reset		&& Resets stopwatch.
		This.nSec = 0
		This.nMin = 0
		This.nHour = 0
		This.UpdateDisplay
	ENDPROC

	PROCEDURE start		&& Starts stopwatch.
		This.tmrSWatch.enabled = .T.
	ENDPROC

	PROCEDURE stop		&& Stops stopwatch.
		This.tmrSWatch.enabled = .f.
	ENDPROC

	PROCEDURE updatedisplay		&& Refresh display.
		LOCAL cSecDisplay , cMinDisplay, cHourDisplay  
		
		cSecDisplay = ALLTRIM(STR(This.nSec))
		cMinDisplay = ALLTRIM(STR(This.nMin))
		cHourDisplay = ALLTRIM(STR(This.nHour))
		
		This.lblSeconds.Caption = IIF(This.nSec < 10, "0" + m.cSecDisplay , m.cSecDisplay)
		This.lblMinutes.Caption = IIF(This.nMin < 10, "0" + m.cMinDisplay , m.cMinDisplay)
		This.lblHours.Caption = IIF(This.nHour < 10, "0" + m.cHourDisplay , m.cHourDisplay)
		
	ENDPROC

	PROCEDURE tmrSWatch.Timer
		THIS.Parent.Increment
		
	ENDPROC

ENDDEFINE
